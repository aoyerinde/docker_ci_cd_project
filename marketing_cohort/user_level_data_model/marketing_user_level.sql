CREATE TABLE IF NOT EXISTS KG_DWH.L2_MARKETING_USER_LEVEL_MODEL.MARKETING_USER_LEVEL
(
    INSTALL_TIME                               TIMESTAMP_NTZ,
    APPSFLYER_DEVICE_ID                        VARCHAR,
    GAME_NAME                                  VARCHAR,
    PLATFORM                                   VARCHAR,
    SOURCE                                     VARCHAR,
    MEDIA_SOURCE                               VARCHAR,
    COUNTRY_CODE                               VARCHAR,
    CAMPAIGN_NAME                              VARCHAR,
    SUB_CAMPAIGN_NAME                          VARCHAR,
    CAMPAIGN_ID                                VARCHAR,
    SUB_CAMPAIGN_ID                            VARCHAR,
    OS_VERSION                                 VARCHAR,
    DEVICE_BRAND                               VARCHAR,
    DEVICE_MODEL                               VARCHAR,
    ADVERTISING_ID                             VARCHAR,
    IDFA                                       VARCHAR,
    AF_AD                                      VARCHAR,
    AF_AD_ID                                   VARCHAR,
    AF_AD_TYPE                                 VARCHAR,
    AF_SUB1                                    VARCHAR,
    AF_SUB2                                    VARCHAR,
    AF_SUB3                                    VARCHAR,
    AF_SUB4                                    VARCHAR,
    AF_SUB5                                    VARCHAR,
    AF_KEYWORDS                                VARCHAR,
    AF_SITEID                                  VARCHAR,
    AF_CHANNEL                                 VARCHAR,
    AF_COST_MODEL                              VARCHAR,
    INSTALL_DATE                               DATE,
    EVENT_DATE                                 DATE,
    CPI                                        FLOAT,
    LANGUAGE                                   VARCHAR,
    AD_WATCHED_COUNT                           NUMBER,
    D01_AD_WATCHED_COUNT                       NUMBER,
    D02_AD_WATCHED_COUNT                       NUMBER,
    D03_AD_WATCHED_COUNT                       NUMBER,
    D04_AD_WATCHED_COUNT                       NUMBER,
    D05_AD_WATCHED_COUNT                       NUMBER,
    D06_AD_WATCHED_COUNT                       NUMBER,
    D07_AD_WATCHED_COUNT                       NUMBER,
    D14_AD_WATCHED_COUNT                       NUMBER,
    D30_AD_WATCHED_COUNT                       NUMBER,
    D60_AD_WATCHED_COUNT                       NUMBER,
    D90_AD_WATCHED_COUNT                       NUMBER,
    AD_WATCHED_REVENUE                         FLOAT,
    D01_AD_WATCHED_REVENUE                     FLOAT,
    D02_AD_WATCHED_REVENUE                     FLOAT,
    D03_AD_WATCHED_REVENUE                     FLOAT,
    D04_AD_WATCHED_REVENUE                     FLOAT,
    D05_AD_WATCHED_REVENUE                     FLOAT,
    D06_AD_WATCHED_REVENUE                     FLOAT,
    D07_AD_WATCHED_REVENUE                     FLOAT,
    D14_AD_WATCHED_REVENUE                     FLOAT,
    D30_AD_WATCHED_REVENUE                     FLOAT,
    D60_AD_WATCHED_REVENUE                     FLOAT,
    D90_AD_WATCHED_REVENUE                     FLOAT,
    PURCHASE_COUNT                             NUMBER,
    D01_PURCHASE_COUNT                         NUMBER,
    D02_PURCHASE_COUNT                         NUMBER,
    D03_PURCHASE_COUNT                         NUMBER,
    D04_PURCHASE_COUNT                         NUMBER,
    D05_PURCHASE_COUNT                         NUMBER,
    D06_PURCHASE_COUNT                         NUMBER,
    D07_PURCHASE_COUNT                         NUMBER,
    D14_PURCHASE_COUNT                         NUMBER,
    D30_PURCHASE_COUNT                         NUMBER,
    D60_PURCHASE_COUNT                         NUMBER,
    D90_PURCHASE_COUNT                         NUMBER,
    PURCHASE_REVENUE_GROSS                     FLOAT,
    D01_PURCHASE_REVENUE_GROSS                 FLOAT,
    D02_PURCHASE_REVENUE_GROSS                 FLOAT,
    D03_PURCHASE_REVENUE_GROSS                 FLOAT,
    D04_PURCHASE_REVENUE_GROSS                 FLOAT,
    D05_PURCHASE_REVENUE_GROSS                 FLOAT,
    D06_PURCHASE_REVENUE_GROSS                 FLOAT,
    D07_PURCHASE_REVENUE_GROSS                 FLOAT,
    D14_PURCHASE_REVENUE_GROSS                 FLOAT,
    D30_PURCHASE_REVENUE_GROSS                 FLOAT,
    D60_PURCHASE_REVENUE_GROSS                 FLOAT,
    D90_PURCHASE_REVENUE_GROSS                 FLOAT,
    PURCHASE_REVENUE_AFTER_SHARE               FLOAT,
    D01_PURCHASE_REVENUE_AFTER_SHARE           FLOAT,
    D02_PURCHASE_REVENUE_AFTER_SHARE           FLOAT,
    D03_PURCHASE_REVENUE_AFTER_SHARE           FLOAT,
    D04_PURCHASE_REVENUE_AFTER_SHARE           FLOAT,
    D05_PURCHASE_REVENUE_AFTER_SHARE           FLOAT,
    D06_PURCHASE_REVENUE_AFTER_SHARE           FLOAT,
    D07_PURCHASE_REVENUE_AFTER_SHARE           FLOAT,
    D14_PURCHASE_REVENUE_AFTER_SHARE           FLOAT,
    D30_PURCHASE_REVENUE_AFTER_SHARE           FLOAT,
    D60_PURCHASE_REVENUE_AFTER_SHARE           FLOAT,
    D90_PURCHASE_REVENUE_AFTER_SHARE           FLOAT,
    PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT     FLOAT,
    D01_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT FLOAT,
    D02_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT FLOAT,
    D03_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT FLOAT,
    D04_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT FLOAT,
    D05_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT FLOAT,
    D06_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT FLOAT,
    D07_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT FLOAT,
    D14_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT FLOAT,
    D30_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT FLOAT,
    D60_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT FLOAT,
    D90_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT FLOAT,
    TO_DATE_COAL_SHAFT_5_COUNT                 NUMBER,
    D01_COAL_SHAFT_5_COUNT                     NUMBER,
    D02_COAL_SHAFT_5_COUNT                     NUMBER,
    D03_COAL_SHAFT_5_COUNT                     NUMBER,
    D04_COAL_SHAFT_5_COUNT                     NUMBER,
    D05_COAL_SHAFT_5_COUNT                     NUMBER,
    D06_COAL_SHAFT_5_COUNT                     NUMBER,
    D07_COAL_SHAFT_5_COUNT                     NUMBER,
    D14_COAL_SHAFT_5_COUNT                     NUMBER,
    D30_COAL_SHAFT_5_COUNT                     NUMBER,
    D60_COAL_SHAFT_5_COUNT                     NUMBER,
    D90_COAL_SHAFT_5_COUNT                     NUMBER,
    INSERT_TIME                                TIMESTAMP_NTZ,
    _TST                                       TIMESTAMP_NTZ


);

BEGIN;

TRUNCATE TABLE KG_DWH.L2_MARKETING_USER_LEVEL_MODEL.MARKETING_USER_LEVEL;

INSERT INTO KG_DWH.L2_MARKETING_USER_LEVEL_MODEL.MARKETING_USER_LEVEL

SELECT USER_INSTALL.INSTALL_TIME,
       USER_INSTALL.APPSFLYER_DEVICE_ID,
       USER_INSTALL.GAME_NAME,
       USER_INSTALL.PLATFORM,
       USER_INSTALL.SOURCE,
       USER_INSTALL.MEDIA_SOURCE,
       USER_INSTALL.COUNTRY_CODE,
       USER_INSTALL.CAMPAIGN_NAME,
       USER_INSTALL.SUB_CAMPAIGN_NAME,
       USER_INSTALL.CAMPAIGN_ID,
       USER_INSTALL.SUB_CAMPAIGN_ID,
       USER_INSTALL.OS_VERSION,
       USER_INSTALL.DEVICE_BRAND,
       USER_INSTALL.DEVICE_MODEL,
       USER_INSTALL.ADVERTISING_ID,
       USER_INSTALL.IDFA,
       USER_INSTALL.AF_AD,
       USER_INSTALL.AF_AD_ID,
       USER_INSTALL.AF_AD_TYPE,
       USER_INSTALL.AF_SUB1,
       USER_INSTALL.AF_SUB2,
       USER_INSTALL.AF_SUB3,
       USER_INSTALL.AF_SUB4,
       USER_INSTALL.AF_SUB5,
       USER_INSTALL.AF_KEYWORDS,
       USER_INSTALL.AF_SITEID,
       USER_INSTALL.AF_CHANNEL,
       USER_INSTALL.AF_COST_MODEL,
       USER_INSTALL.INSTALL_DATE,
       USER_INSTALL.EVENT_DATE,
       USER_INSTALL.CPI,
       USER_INSTALL.LANGUAGE,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.AD_WATCHED_COUNT)                             AD_WATCHED_COUNT,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D01_AD_WATCHED_COUNT)                         D01_AD_WATCHED_COUNT,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D02_AD_WATCHED_COUNT)                         D02_AD_WATCHED_COUNT,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D03_AD_WATCHED_COUNT)                         D03_AD_WATCHED_COUNT,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D04_AD_WATCHED_COUNT)                         D04_AD_WATCHED_COUNT,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D05_AD_WATCHED_COUNT)                         D05_AD_WATCHED_COUNT,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D06_AD_WATCHED_COUNT)                         D06_AD_WATCHED_COUNT,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D07_AD_WATCHED_COUNT)                         D07_AD_WATCHED_COUNT,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D14_AD_WATCHED_COUNT)                         D14_AD_WATCHED_COUNT,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D30_AD_WATCHED_COUNT)                         D30_AD_WATCHED_COUNT,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D60_AD_WATCHED_COUNT)                         D60_AD_WATCHED_COUNT,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D90_AD_WATCHED_COUNT)                         D90_AD_WATCHED_COUNT,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.AD_WATCHED_REVENUE)                           AD_WATCHED_REVENUE,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D01_AD_WATCHED_REVENUE)                       D01_AD_WATCHED_REVENUE,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D02_AD_WATCHED_REVENUE)                       D02_AD_WATCHED_REVENUE,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D03_AD_WATCHED_REVENUE)                       D03_AD_WATCHED_REVENUE,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D04_AD_WATCHED_REVENUE)                       D04_AD_WATCHED_REVENUE,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D05_AD_WATCHED_REVENUE)                       D05_AD_WATCHED_REVENUE,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D06_AD_WATCHED_REVENUE)                       D06_AD_WATCHED_REVENUE,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D07_AD_WATCHED_REVENUE)                       D07_AD_WATCHED_REVENUE,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D14_AD_WATCHED_REVENUE)                       D14_AD_WATCHED_REVENUE,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D30_AD_WATCHED_REVENUE)                       D30_AD_WATCHED_REVENUE,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D60_AD_WATCHED_REVENUE)                       D60_AD_WATCHED_REVENUE,
       ZEROIFNULL(AD_WATCHED_COUNT_REVENUE.D90_AD_WATCHED_REVENUE)                       D90_AD_WATCHED_REVENUE,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.PURCHASE_COUNT)                          PURCHASE_COUNT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D01_PURCHASE_COUNT)                      D01_PURCHASE_COUNT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D02_PURCHASE_COUNT)                      D02_PURCHASE_COUNT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D03_PURCHASE_COUNT)                      D03_PURCHASE_COUNT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D04_PURCHASE_COUNT)                      D04_PURCHASE_COUNT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D05_PURCHASE_COUNT)                      D05_PURCHASE_COUNT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D06_PURCHASE_COUNT)                      D06_PURCHASE_COUNT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D07_PURCHASE_COUNT)                      D07_PURCHASE_COUNT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D14_PURCHASE_COUNT)                      D14_PURCHASE_COUNT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D30_PURCHASE_COUNT)                      D30_PURCHASE_COUNT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D60_PURCHASE_COUNT)                      D60_PURCHASE_COUNT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D90_PURCHASE_COUNT)                      D90_PURCHASE_COUNT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.PURCHASE_REVENUE_GROSS)                  PURCHASE_REVENUE_GROSS,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D01_PURCHASE_REVENUE_GROSS)              D01_PURCHASE_REVENUE_GROSS,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D02_PURCHASE_REVENUE_GROSS)              D02_PURCHASE_REVENUE_GROSS,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D03_PURCHASE_REVENUE_GROSS)              D03_PURCHASE_REVENUE_GROSS,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D04_PURCHASE_REVENUE_GROSS)              D04_PURCHASE_REVENUE_GROSS,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D05_PURCHASE_REVENUE_GROSS)              D05_PURCHASE_REVENUE_GROSS,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D06_PURCHASE_REVENUE_GROSS)              D06_PURCHASE_REVENUE_GROSS,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D07_PURCHASE_REVENUE_GROSS)              D07_PURCHASE_REVENUE_GROSS,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D14_PURCHASE_REVENUE_GROSS)              D14_PURCHASE_REVENUE_GROSS,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D30_PURCHASE_REVENUE_GROSS)              D30_PURCHASE_REVENUE_GROSS,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D60_PURCHASE_REVENUE_GROSS)              D60_PURCHASE_REVENUE_GROSS,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D90_PURCHASE_REVENUE_GROSS)              D90_PURCHASE_REVENUE_GROSS,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.PURCHASE_REVENUE_AFTER_SHARE)            PURCHASE_REVENUE_AFTER_SHARE,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D01_PURCHASE_REVENUE_AFTER_SHARE)           D01_PURCHASE_REVENUE_AFTER_SHARE,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D02_PURCHASE_REVENUE_AFTER_SHARE)           D02_PURCHASE_REVENUE_AFTER_SHARE,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D03_PURCHASE_REVENUE_AFTER_SHARE)           DO3_PURCHASE_REVENUE_AFTER_SHARE,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D04_PURCHASE_REVENUE_AFTER_SHARE)           D04_PURCHASE_REVENUE_AFTER_SHARE,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D05_PURCHASE_REVENUE_AFTER_SHARE)           D05_PURCHASE_REVENUE_AFTER_SHARE,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D06_PURCHASE_REVENUE_AFTER_SHARE)           D06_PURCHASE_REVENUE_AFTER_SHARE,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D07_PURCHASE_REVENUE_AFTER_SHARE)           D07_PURCHASE_REVENUE_AFTER_SHARE,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D14_PURCHASE_REVENUE_AFTER_SHARE)           D14_PURCHASE_REVENUE_AFTER_SHARE,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D30_PURCHASE_REVENUE_AFTER_SHARE)           D30_PURCHASE_REVENUE_AFTER_SHARE,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D60_PURCHASE_REVENUE_AFTER_SHARE)           D60_PURCHASE_REVENUE_AFTER_SHARE,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D90_PURCHASE_REVENUE_AFTER_SHARE)           D90_PURCHASE_REVENUE_AFTER_SHARE,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT)     PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D01_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT) D01_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D02_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT) D02_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D03_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT) D03_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D04_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT) D04_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D05_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT) D05_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D06_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT) D06_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D07_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT) D07_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D14_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT) D14_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D30_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT) D30_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D60_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT) D60_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT,
       ZEROIFNULL(IN_APP_PURCHASE_COUNT_REVENUE.D90_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT) D90_PURCHASE_REVENUE_AFTER_SHARE_AFTER_VAT,
       ZEROIFNULL(COAL_SHAFT_5_COUNT.TO_DATE_COAL_SHAFT_5_COUNT)                         TO_DATE_COAL_SHAFT_5_COUNT,
       ZEROIFNULL(COAL_SHAFT_5_COUNT.D01_COAL_SHAFT_5_COUNT)                             D01_COAL_SHAFT_5_COUNT,
       ZEROIFNULL(COAL_SHAFT_5_COUNT.D02_COAL_SHAFT_5_COUNT)                             D02_COAL_SHAFT_5_COUNT,
       ZEROIFNULL(COAL_SHAFT_5_COUNT.D03_COAL_SHAFT_5_COUNT)                             D03_COAL_SHAFT_5_COUNT,
       ZEROIFNULL(COAL_SHAFT_5_COUNT.D04_COAL_SHAFT_5_COUNT)                             D04_COAL_SHAFT_5_COUNT,
       ZEROIFNULL(COAL_SHAFT_5_COUNT.D05_COAL_SHAFT_5_COUNT)                             D05_COAL_SHAFT_5_COUNT,
       ZEROIFNULL(COAL_SHAFT_5_COUNT.D06_COAL_SHAFT_5_COUNT)                             D06_COAL_SHAFT_5_COUNT,
       ZEROIFNULL(COAL_SHAFT_5_COUNT.D07_COAL_SHAFT_5_COUNT)                             D07_COAL_SHAFT_5_COUNT,
       ZEROIFNULL(COAL_SHAFT_5_COUNT.D14_COAL_SHAFT_5_COUNT)                             D14_COAL_SHAFT_5_COUNT,
       ZEROIFNULL(COAL_SHAFT_5_COUNT.D30_COAL_SHAFT_5_COUNT)                             D30_COAL_SHAFT_5_COUNT,
       ZEROIFNULL(COAL_SHAFT_5_COUNT.D60_COAL_SHAFT_5_COUNT)                             D60_COAL_SHAFT_5_COUNT,
       ZEROIFNULL(COAL_SHAFT_5_COUNT.D90_COAL_SHAFT_5_COUNT)                             D90_COAL_SHAFT_5_COUNT,
       CURRENT_TIMESTAMP::TIMESTAMP_NTZ                                                  INSERT_TIME,
       USER_INSTALL.INSTALL_DATE::TIMESTAMP_NTZ                                          _TST


FROM KG_DWH.L2_MARKETING_USER_LEVEL_MODEL.USER_INSTALL USER_INSTALL
         LEFT JOIN KG_DWH.L2_MARKETING_USER_LEVEL_MODEL.USER_AD_WATCHED AD_WATCHED_COUNT_REVENUE
                   ON (USER_INSTALL.APPSFLYER_DEVICE_ID = AD_WATCHED_COUNT_REVENUE.APPSFLYER_DEVICE_ID
                       AND USER_INSTALL.INSTALL_TIME = AD_WATCHED_COUNT_REVENUE.INSTALL_TIME)
         LEFT JOIN KG_DWH.L2_MARKETING_USER_LEVEL_MODEL.USER_IN_APP_PURCHASE IN_APP_PURCHASE_COUNT_REVENUE
                   ON (USER_INSTALL.APPSFLYER_DEVICE_ID = IN_APP_PURCHASE_COUNT_REVENUE.APPSFLYER_DEVICE_ID
                       AND USER_INSTALL.INSTALL_TIME = IN_APP_PURCHASE_COUNT_REVENUE.INSTALL_TIME)
         LEFT JOIN KG_DWH.L2_MARKETING_USER_LEVEL_MODEL.USER_COAL_SHAFT_5_COUNT COAL_SHAFT_5_COUNT
                   ON (USER_INSTALL.APPSFLYER_DEVICE_ID = COAL_SHAFT_5_COUNT.APPSFLYER_DEVICE_ID
                       AND USER_INSTALL.INSTALL_TIME = COAL_SHAFT_5_COUNT.INSTALL_TIME)
;

COMMIT;
